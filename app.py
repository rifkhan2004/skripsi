import streamlit as st
from pathlib import Path
import base64

# Set page config
st.set_page_config(
    page_title="OII Network Visualisation",
    layout="wide",
    initial_sidebar_state="collapsed"
)

# ==============================================
# SEMUA DEPENDENSI DISEMATKAN LANGSUNG DALAM KODE
# ==============================================

# 1. CSS Styles
CSS_STYLE = """
/* style.css */
.sigma-parent {
    position: relative;
    width: 100%;
    height: 100%;
    border: 1px solid #ccc;
}

.sigma-expand {
    position: absolute;
    width: 100%;
    height: 100%;
}

#mainpanel {
    position: absolute;
    top: 20px;
    left: 20px;
    background: rgba(255,255,255,0.9);
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
    z-index: 100;
}

/* tablet.css */
@media screen and (max-height: 770px) {
    #mainpanel {
        font-size: 0.8em;
    }
}

/* Fancybox CSS */
.fancybox-wrap, .fancybox-skin {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 8020;
}
"""

# 2. JavaScript Libraries
JQUERY_JS = """
/* jquery.min.js - versi ringkas */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var n=[],r=e.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function e(t){return"function"==typeof t&&"number"!=typeof t.nodeType},y=function e(t){return null!=t&&t===t.window},v={type:!0,src:!0,noModule:!0};function m(e,t,n){var i,o=(t=t||r).createElement("script");if(o.text=e,n)for(i in v)n[i]&&(o[i]=n[i]);t.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var b="3.6.0",w=function(e,t){return new w.fn.init(e,t)},T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.fn=w.prototype={jquery:"3.6.0",constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||g(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&&(l&&r&&(w.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&w.isPlainObject(n)?n:{},a[t]=w.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},w.extend({expando:"jQuery"+("3.6.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==c.call(e))&&(!(t=i(e))||"function"==typeof(n=f.call(t,"constructor")&&t.constructor)&&p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){m(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(C(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(C(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,s=0,u=[];if(C(e))for(r=e.length;s<r;s++)null!=(i=t(e[s],s,n))&&u.push(i);else for(s in e)null!=(i=t(e[s],s,n))&&u.push(i);return a.apply([],u)},guid:1,support:h}),"function"==typeof Symbol&&w.fn[Symbol.iterator]=n[Symbol.iterator],w.extend("isFunction",function(e){return"function"==typeof e}),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function C(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!g(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}var E=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,y,v,m,x,b="sizzle"+1*new Date,w=e.document,T=0,C=0,E=ue(),k=ue(),S=ue(),D=ue(),N=function(e,t){return e===t&&(f=!0),0},A={}.hasOwnProperty,j=[],L=j.pop,q=j.push,H=j.push,O=j.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",$=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),F=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp($),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+$),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{H.apply(j=O.call(w.childNodes),w.childNodes),j[w.childNodes.length].nodeType}catch(e){H={apply:j.length?function(e,t){q.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(e,t,r,i){var o,a,s,u,l,c,f,p=t&&t.ownerDocument,d=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==d&&9!==d&&11!==d)return r;if(!i&&((t?t.ownerDocument||t:w)!==E&&T(t),t=t||E,11===d&&!l)return o=Z.exec(e),o?(t.getElementById(o[1])?[t.getElementById(o[1])]:[]):r;if(!i&&!l)if(o=ee.exec(e))if(u=o[1]){if(9===d){if(!(s=t.getElementById(u)))return r;if(s.id===u)return r.push(s),r}else if(p&&(s=p.getElementById(u))&&y(t,s)&&s.id===u)return r.push(s),r}else{if(o[2])return H.apply(r,t.getElementsByTagName(e)),r;if((u=o[3])&&h.getElementsByClassName&&t.getElementsByClassName)return H.apply(r,t.getElementsByClassName(u)),r}return h.qsa&&!D[e+" "]&&(!v||!v.test(e))&&(1===d||"object"!==t.nodeName.toLowerCase())?(f=t,p=e,1===d&&U.test(e)&&(a=me(t),s=a.id,c=!s&&n++,s||(a.id=c||t.id),u=ge(e).map(function(e){return e.replace(re,ie)}),f=ee.test(e)&&ve(t)||t,u="[id='"+s+"'] "+u.join(",")),try{H.apply(r,f.querySelectorAll(u)),r}catch(e){}finally{c&&!a.id&&a.removeAttribute("id")}):ve(e.replace(F,"$1"),t,r,i)}function ue(){var e=[];return function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function le(e){return e[b]=!0,e}function ce(e){var t=E.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),i=n.length;while(i--)r.attrHandle[n[i]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){var t=[];return function e(n,r){var i,o,a,s=n.length;if(!s)return t;for(i=0;i<s;i++)if(o=n[i],o)if(g(o)&&(a=o.nodeType,r&&(o.ownerDocument||o)!==E&&T(o),1===o.nodeType)){if(t.push(o),o.childNodes.length&&r){e(o.childNodes,r)}else if(a===1||a===9||a===11){var u=o.nodeName.toLowerCase();"script"!==u&&"style"!==u&&t.push(o)}}return t}(Array.isArray(e)?e:[e],!0)}function ye(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&h.contains(e.ownerDocument,e)&&"none"===h.css(e,"display")}function ve(e){var t,n,r=e.ownerDocument,i=e.nodeName,o=Y.test(i),a=!o&&"hidden"in e,s=o||"offsetHeight"in e;if(o)return!ye(e);if(a)return ye(e);t=r.documentElement,n=e.getBoundingClientRect(),i=(e.offsetParent||t).clientTop,(t=r.documentElement).clientTop;return n.top+e.clientTop-i<0}function me(e){var t,n,r=e.ownerDocument,i=e.nodeName,o=r.documentElement,a=o.clientTop||0;return"fixed"===h.css(e,"position")?e.getBoundingClientRect().top-a:(t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView,(n?n.pageYOffset:o.scrollTop)-a+t.top)}function xe(e){return{top:e.top,left:e.left}}function be(e,t){var n="function"==typeof e?e:t,r="function"==typeof t?t:!1;return function(i){return i.matchesSelector(e)?n(i):r?void 0:be(e,n)}}function we(e,t){for(var n=e.parentNode;n&&n!==t;n=n.parentNode);return n===t}function Te(e,t){return e.parentNode&&e.parentNode.removeChild(e),t.insertBefore(e,t.firstChild),e}function Ce(e){var t=e&&e.parentNode;return t&&11!==t.nodeType?t:null}function Ee(e,t){var n=e?e.length:0;if(n)for(var r=0,i=0;r<n;r++)t(e[r],i++)}function ke(e,t){return t?Array.prototype.slice.call(e):e}function Se(e,t,n){var r=t.dir,i=n&&"parentNode"===r,o=C++;return t.first?function(t,n,o){while(t=t[r])if(1===t.nodeType||i)return e(t,n,o)}:function(t,n,a){var s,u,l,c=[S,o];if(a){while(t=t[r])if((1===t.nodeType||i)&&e(t,n,a))return!0}else while(t=t[r])if(1===t.nodeType||i){if(u=t[b]||(t[b]={}),(l=u[r])&&l[0]===S&&l[1]===o)return c[2]=l[2];if(u[r]=c,c[2]=e(t,n,a))return!0}}}function De(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function Ne(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;s<u;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&q.push(t[s]));return a}function Ae(e,t,n,r,i,o){return r&&!r[b]&&(r=Ae(r)),i&&!i[b]&&(i=Ae(i,o)),be(function(o,a,s,u){var l,c,f,p=[],d=[],h=a.length,g=o||Ee(t||"*",s.nodeType?[s]:s,[]),y=!e||!o&&t?g:Ne(g,p,e,s,u),v=n?i||(o?e:h||r)?[]:a:y;if(n&&n(y,v,s,u),r){l=Ne(v,d),r(l,[],s,u),c=l.length;while(c--)(f=l[c])&&(v[d[c]]=!(y[d[c]]=f))}if(o){if(i||e){if(i){l=[],c=v.length;while(c--)(f=v[c])&&l.push(y[c]=f);i(null,v=[],l,u)}c=v.length;while(c--)(f=v[c])&&(l=i?P(o,f):p[c])>-1&&(o[l]=!(a[l]=f))}}else v=Ne(v===a?v.splice(h,v.length):v),i?i(null,a,v,u):H.apply(a,v)})}function je(e){var t,n,r,i=e.length,o=r.relative[e[0].type],a=o||r.relative[" "],s=o?1:0,u=Se(function(e){return e===t},a,!0),l=Se(function(e){return P(t,e)>-1},a,!0),c=[function(e,n,r){var i=!o&&(r||n!==k)||((t=n).nodeType?u(e,n,r):l(e,n,r));return t=null,i}];for(;s<i;s++)if(n=r.relative[e[s].type])c=[Se(De(c),n)];else{if(n=r.filter[e[s].type].apply(null,e[s].matches),n[b]){for(r=++s;r<i&&!r.relative[e[r].type];r++);return Ae(s>1&&De(c),s>1&&ge(e.slice(0,s-1).join("")),s>1&&s<i&&ge(e.slice(s,r)),r<i&&je(e.slice(r,i)),s>1&&je(e.slice(0,s-1)),n}if(n.length>1)c.push.apply(c,n);else c.push(n)}return De(c)}function Le(e,t){var n=0,i=t.length>0,o=e.length>0,a=function(a,s,u,l,c){var f,p,d,h=[],g=0,y="0",v=a&&[],m=null!=c,x=k,b=a||o&&r.find.TAG("*",c&&s.parentNode||s),w=S+=null==x?1:Math.random()||.1;for(m&&(k=s!==E&&s,T=n);null!=(f=b[y]);y++){if(o&&f){p=0;while(d=e[p++])if(d(f,s,u)){l.push(f);break}m&&(S=w,T=++n)}i&&((f=!d&&f)&&g--,a&&v.push(f))}if(g+=y,i&&y!==g){p=0;while(d=t[p++])d(v,h,s,u);if(a){if(g>0)while(y--)v[y]||h[y]||(h[y]=L.call(l));h=Ne(h)}H.apply(l,h),m&&!a&&h.length>0&&g>1&&oe.uniqueSort(l)}return m&&(S=w,k=x),v};return i?be(a):a}function qe(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function He(e,t,n){var r=0,i=t.length;for(;r<i;r++)se(e,t[r],n);return n}function Oe(e,t,n,r,i){var o,a,s,u=[],l=0,c=e.length,f=null!=t;for(;l<c;l++)(o=e[l])&&(n&&!n(o,r,i)||(u.push(o),f&&q.push(t[l])));return u}function Pe(e,t,n,r,i,o){return r&&!r[b]&&(r=Pe(r)),i&&!i[b]&&(i=Pe(i,o)),be(function(o,a,s,u){var l,c,f,p=[],d=[],h=a.length,g=o||Ee(t||"*",s.nodeType?[s]:s,[]),y=!e||!o&&t?g:Oe(g,p,e,s,u),v=n?i||(o?e:h||r)?[]:a:y;if(n&&n(y,v,s,u),r){l=Oe(v,d),r(l,[],s,u),c=l.length;while(c--)(f=l[c])&&(v[d[c]]=!(y[d[c]]=f))}if(o){if(i||e){if(i){l=[],c=v.length;while(c--)(f=v[c])&&l.push(y[c]=f);i(null,v=[],l,u)}c=v.length;while(c--)(f=v[c])&&(l=i?P(o,f):p[c])>-1&&(o[l]=!(a[l]=f))}}else v=Oe(v===a?v.splice(h,v.length):v),i?i(null,a,v,u):H.apply(a,v)})}function Re(e){var t,n,r,i=e.length,o=r.relative[e[0].type],a=o||r.relative[" "],s=o?1:0,u=Se(function(e){return e===t},a,!0),l=Se(function(e){return P(t,e)>-1},a,!0),c=[function(e,n,r){var i=!o&&(r||n!==k)||((t=n).nodeType?u(e,n,r):l(e,n,r));return t=null,i}];for(;s<i;s++)if(n=r.relative[e[s].type])c=[Se(qe(c),n)];else{if(n=r.filter[e[s].type].apply(null,e[s].matches),n[b]){for(r=++s;r<i&&!r.relative[e[r].type];r++);return Pe(s>1&&qe(c),s>1&&ge(e.slice(0,s-1).join("")),s>1&&s<i&&ge(e.slice(s,r)),r<i&&Re(e.slice(r,i)),s>1&&Re(e.slice(0,s-1)),n}if(n.length>1)c.push.apply(c,n);else c.push(n)}return qe(c)}function Me(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,u,l){var c,f,p,d=0,h="0",g=o&&[],y=[],v=k,m=o||i&&r.find.TAG("*",l),x=S+=null==v?1:Math.random()||.1,b=null!=l;for(b&&(k=a!==E&&a,T=n);null!=(c=m[h]);h++){if(i&&c){f=0;while(p=e[f++])if(p(c,a,s)){u.push(c);break}b&&(S=x,T=++n)}n&&((c=!p&&c)&&d--,o&&g.push(c))}if(d+=h,n&&h!==d){f=0;while(p=t[f++])p(g,y,a,s);if(o){if(d>0)while(h--)g[h]||y[h]||(y[h]=L.call(u));y=Oe(y)}H.apply(u,y),b&&!o&&y.length>0&&d>1&&oe.uniqueSort(u)}return b&&(S=x,k=v),g};return n?be(o):o}function Ie(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ae(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function We(e){return le(function(t){return t=+t,le(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function $e(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function Be(){}function Fe(e){var t,n,r,i,o,a=[],s=[],u=N.test(e)+" ",l=e+" ",c=0,f=0;for(t=(e=$e(e)||e).nodeType?[e]:e;null!=(r=t[c]);c++)if(1===r.nodeType){for(o=r.getAttribute("id"),o=o&&o.replace(re,ie),a[o]=r,i=r.getElementsByTagName("*"),n=0;n<i.length;n++)o=i[n].getAttribute("id"),o&&(a[o]=i[n]);if(u){for(n=0;n<i.length;n++)s.push(i[n]);s.push(r)}}return{context:t,selector:l,results:a,unique:f,set:s}}function _e(e,t,n){var r=[],i=[],o=0,a=e.length;for(;o<a;o++){var s=e[o];s.style&&(r.push(s),i.push(s.style.display),s.style.display=t?"none":""}n&&n(),o=0;for(;o<r.length;o++)r[o].style.display=i[o];return e}function ze(e,t,n,r,i){return new ze.prototype.init(e,t,n,r,i)}function Ue(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?t:"number"===i?t.toString():"string"===i?(n=t.toLowerCase())===!1||"false"===n?!1:t===!0||"true"===n?!0:isNaN(t)?t:+t:"function"===i?t.toString():t}function Xe(e){return"string"==typeof e?e:e instanceof String?e.toString():""+e}function Ve(e){return e&&"object"==typeof e&&"length"in e&&e.length!==+e.length&&!w.isFunction(e)?w.makeArray(e):null==e?[]:"string"==typeof e?[e]:Array.isArray(e)?e:[e]}function Ge(e,t,n){var r,i,o,a,s=e.style;return n=n||we(e),n&&(a=n.getPropertyValue(t)||n[t]),""!==a&&void 0!==a||y(e)||(a=w.style(e,t)),n&&!h.pixelMarginRight()&&G.test(a)&&R.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o),void 0!==a?a+"":a}function Ye(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function Qe(e){if(e in j)return e;var t=e[0].toUpperCase()+e.slice(1),n=0,r=R.length;for(;n<r;n++){var i=R[n]+t;if(i in j)return i}}function Je(e,t,n){var r=W.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ke(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;o<4;o+=2)"margin"===n&&(a+=w.css(e,n+V[o],!0,i)),r?("content"===n&&(a-=w.css(e,"padding"+V[o],!0,i)),"margin"!==n&&(a-=w.css(e,"border"+V[o]+"Width",!0,i))):(a+=w.css(e,"padding"+V[o],!0,i),"padding"!==n&&(a+=w.css(e,"border"+V[o]+"Width",!0,i));return a}function Ze(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=we(e),a=h.boxSizing()&&"border-box"===w.css(e,"boxSizing",!1,o);if(i<=0||null==i){if(i=Ge(e,t,o),(i<0||null==i)&&(i=e.style[t]),G.test(i))return i;r=a&&(h.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+Ke(e,t,n||(a?"border":"content"),r,o)+"px"}function et(e,t,n,r,i){return new et.prototype.init(e,t,n,r,i)}function tt(e,t){var n,r={};for(n in t)r[n]=e.style[n],e.style[n]=t[n];return function(){for(n in t)e.style[n]=r[n]}}function nt(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return w.css(e,t,"")},u=s(),l=n&&n[3]||(w.cssNumber[t]?"":"px"),c=(w.cssNumber[t]||"px"!==l&&+u)&&W.exec(w.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)w.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,w.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}function rt(e){var t,n=e.ownerDocument,r=e.nodeName,i=Y.test(r);return n?(t=n.defaultView):e.parentNode&&(t=e.parentNode.ownerDocument.defaultView),t&&t.getComputedStyle&&!i?t.getComputedStyle(e,null):{}}function it(e,t,n){var r,i,o,a,s=e.style;return n=n||we(e),o=n?n.getPropertyValue(t)||n[t]:void 0,""!==o&&void 0!==o||y(e)||(o=w.style(e,t)),n&&!h.pixelMarginRight()&&G.test(o)&&R.test(t)&&(r=s.width,i=s.minWidth,a=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=n.width,s.width=r,s.minWidth=i,s.maxWidth=a),void 0!==o?o+"":o}function ot(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}function at(){var e,t,n=0,r=arguments.length;for(e={};n<r;n++)if(t=arguments[n])for(var i in t)e[i]=t[i];return e}function st(e,t,n){var r,i,o,a,s,u,l=this,c={},f=e.style,p=e.nodeType&&ye(e),d=w._data(e,"fxshow");n.queue||(s=w._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,u=s.empty.fire,s.empty.fire=function(){s.unqueued||u()}),s.unqueued++,l.always(function(){l.always(function(){s.unqueued--,w.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===w.css(e,"display")&&"none"===w.css(e,"float")&&(h.inlineBlockNeedsLayout()&&"inline"!==rt(e.nodeName).display?f.zoom=1:f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.shrinkWrapBlocks()||l.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f